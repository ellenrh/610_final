---
title             : "Factors affecting happiness: marriage, health, trust and family savings"
shorttitle        : "Factors affecting happiness"

author: 
  - name          : "Asha Yadav"
    affiliation   : "1"
    corresponding : yes    
    address       : "Postal address"
    email         : "ayadav@uoregon.edu"
  - name          : "Joanna"
    affiliation   : "1"
    corresponding : no    
    address       : "Postal address"
    email         : "jwrigh23@uoregon.edu"
  - name          : "Thuy"
    affiliation   : "1"
    corresponding : no    
    address       : "Postal address"
    email         : "thueyvei@gmail.com"

affiliation:
  - id            : "1"
    institution   : "University of Oregon"

authornote: |
  We thank Dr. Nese for his guidance in this project. All mistakes remain ours. 

abstract: |
  A secondary data analysis was carried out to explore association between happiness and other factors like marriage, trust, family savings and health. Data was obtained from World Value Survey. Data analysis involved descriptive statistics and exploratory data visualization using R. Results indicate that happiness is positively correlated with family savings, health and trust.
  
keywords          : "happiness, health, family savings, trust and world value survey"


bibliography      : [r-references.bib]

floatsintext      : yes
figurelist        : no
tablelist         : no
footnotelist      : no
linenumbers       : no
mask              : no
draft             : no

documentclass     : "apa6"
classoption       : "man, fleqn, noextraspace"
output            : papaja::apa6_pdf

header-includes:
  - \raggedbottom
  - \setlength{\parskip}{0pt}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(warning = FALSE,
                      echo = FALSE)
library("papaja")
library(tidyverse)
library(rio)
library(here)
library(janitor)
library(dplyr)
library(kableExtra)
library(knitr)

```


```{r loading the data}

data <- import(here("data","F00007762-WV6_Data_R_v20180912.rds")) %>%
  janitor::clean_names() %>%
  select("v10", "v11", "v24", "v25", "v57", "v147", "v237", "v240") %>% 
  characterize()

```

```{r renaming variable names}

data <- data %>%
  as_tibble() %>%
    rename(
      feeling_of_happiness = v10, 
      state_of_health = v11, 
      most_people_trusted = v24,
      member_religion = v25,
      marital_status = v57,
      religious_person = v147,
      family_savings = v237,
      gender = v240)

```


```{r cleaning the data: recoding levels}

data <- data %>%
    mutate(feeling_of_happiness = fct_recode(feeling_of_happiness,
                          "Very happy" = "Very happy",
                          "Rather happy" = "Rather happy",
                          "Not very happy" = "Not very happy",
                          "Not at all happy" = "Not at all happy",
                          "Other" = "No answer",
                          "Other" = "Dont know", 
                          "Other" = "HT: Missing-Dropped out survey; RU: Inappropriate response{Inappropriate}"))


data <- data %>%
  mutate(state_of_health = fct_recode(state_of_health,
                          "Very good" = "Very good",
                          "Other" = "No answer",
                          "Other" = "Dont know", 
                          "Other" = "HT: Missing-Dropped out survey; RU: Inappropriate response{Inappropriate}"),
         state_of_health = fct_recode(state_of_health,
         "Very good" = "Very good",
                          "Good" = "Good",
                          "Fair" = "Fair",
                          "Poor" = "Poor",
                          "Other" = "No answer",
                          "Other" = "Dont know", 
                          "Other" = "BH:Missing;HT:Missing-Dropped out survey; RU:Inappropriate response{Inappropriate}")) 
  
data <- data %>%
  mutate(most_people_trusted = fct_recode(most_people_trusted, 
                          "Most people can be trusted" = "Most people can be trusted",
                          "Need to be very careful" = "Need to be very careful",
                          "Other" = "DE,SE: Inapplicable;RU: Inappropiate response;SG:Missing;HT: Dropped out survey{Inappropriate}",
                          "Other" = "No answer",
                          "Other" = "Dont know"))

data <- data %>%
  mutate(member_religion = fct_recode(member_religion, 
                        "Not a member" = "Not a member",
                        "Inactive member" = "Inactive member",
                        "Active member" = "Active member",
                        "Other" =  "HT: Dropped out survey;SE: Inapplicable;RU: Inappropriate response{Inappropriate}",
                        "Other" = "No answer",
                        "Other" = "Dont know"))

data <- data %>%
  mutate(marital_status = fct_recode(marital_status, 
                          "Married" = "Married",
                          "Living together as married" = "Living together as married",
                          "Divorced" = "Divorced",
                          "Separated" = "Separated",
                          "Widowed" = "Widowed",
                          "Single" = "Single",
                          "Other" = "HT: Dropped out survey;SG: Missing; RU: Inappropriate response{Inappropriate}",
                          "Other" = "No answer",
                          "Other" = "Dont know"))

data <- data %>%
  mutate(religious_person = fct_recode(religious_person, 
                           "A religious person" = "A religious person",
                           "Not a religious person" = "Not a religious person",
                           "Not a religious person" = "An atheist",
                           "Other" = "No answer",
                           "Other" = "Dont know",
                           "Other" = "Not asked in survey",
                           "Other" = "DE,SE:Inapplicable ; RU:Inappropriate response; HT: Dropped out survey{Inappropriate}"))

data <- data %>%
mutate(family_savings = fct_recode(family_savings, 
                           "Save money" = "Save money", 
                           "Just get by" = "Just get by", 
                           "Spent savings and borrowed money" = "Spent savings and borrowed money",
                           "Spent some savings and borrowed money" = "Spent some savings and borrowed money",
                           "Other" = "No answer",
                           "Other" = "Dont know", 
                           "Other" = "DE,SE:Inapplicable ; RU:Inappropriate response; BH: Missing; HT: Dropped out survey{Inappropriate}", 
                           "Other" = "Not applicable"))

data <- data %>%
  mutate(gender = fct_recode(gender,
                           "Male" = "Male", 
                           "Female" = "Female", 
                           "Other" = "No answer", 
                           "Other" = "Missing; Unknown")) %>% 
  filter(feeling_of_happiness != "Other" &
           state_of_health != "Other" &
           most_people_trusted != "Other" &
           marital_status != "Other" &
           member_religion != "Other" &
           religious_person != "Other" &
           family_savings != "Other" &
           gender != "Other")

# unique(data_1$gender)
# unique(data_1$feeling_of_happiness)
# unique(data_1$marital_status)
# unique(data_1$state_of_health)

```


```{r happiness and family savings JW, include=FALSE}

save_money <- 21889
spent_some_savings <- 11331
spent_savings <- 8333
just_get_by <- 34669
total <- 21889 + 11331 + 8333 + 34669
percent_save_money <- (save_money/total)*100
percent_spent_some_savings <- (spent_some_savings/total)*100
percent_spent_savings <- (spent_savings/total)*100
percent_just_get_by <- (just_get_by/total)*100

happiness_by_family_savings <- data %>%
  group_by(family_savings) %>%
  count(feeling_of_happiness) %>%
  mutate(total = sum(n)) %>%
  mutate(percent = (n/total)*100)

savings_table_1 <- apa_table(happiness_by_family_savings)

figure_savings_1 <- happiness_by_family_savings %>%
  ggplot(aes(feeling_of_happiness, n)) +
  geom_col(fill = "dark blue") +
  facet_wrap(~family_savings) +
  labs(title = "Figure 1", 
       subtitle = "Happiness levels by family savings: Raw numbers",
       x = "Feeling of happiness",
       y = "Number of people") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))

figure_savings_2 <- happiness_by_family_savings %>%
  group_by(family_savings) %>%
ggplot(aes(feeling_of_happiness, percent)) +
  geom_col(fill = "dark blue") +
  facet_wrap(~family_savings) +
  labs(title = "Figure 2", 
       subtitle = "Happiness levels by family savings: percentage",
       x = "Feeling of happiness",
       y = "Percent") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))

savings_table_2 <- happiness_by_family_savings %>%
  as_tibble() %>%
  arrange(percent)

figure_savings_3 <- happiness_by_family_savings %>%
  ggplot(aes(feeling_of_happiness, percent, colour = family_savings)) +
  geom_point() +
  geom_smooth(se = FALSE, method = lm) +
  labs(Title = "Figure 3",
       subtitle = "Happiness by family savings: percentage", 
       x = "Feeling of Happiness",
       y = "Percent") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))

```


```{r trying out pivot_wider and pivot_longer}

happiness_by_family_savings_1 <- happiness_by_family_savings%>%
  pivot_wider(
    names_from = family_savings,
    values_from = percent)

happiness_by_family_savings_2 <- happiness_by_family_savings_1 %>%
  pivot_longer(
    cols = c("Save money", "Just get by", "Spent some savings and borrowed money", "Spent savings and borrowed money"), 
    names_to = "family_savings",
    values_to = "percent"
  )

```


```{r health, include= FALSE}

happiness_health <- data %>% 
  select("feeling_of_happiness", "state_of_health") %>%  
  group_by(state_of_health) %>%
  mutate(feeling_of_happiness = fct_relevel(feeling_of_happiness,
                                            "Not at all happy",
                                            "Not very happy",
                                            "Rather happy"
                                            )) %>%
  count(feeling_of_happiness)

happiness_health_wider <-happiness_health %>% 
  pivot_wider(
    names_from = feeling_of_happiness,
    values_from = n) 
  
happiness_health_longer <-happiness_health_wider %>% 
  pivot_longer(
    cols = -1,
    names_to = "level_happy", 
    values_to = "number_of_people"
  )

fig_health <- happiness_health_longer %>% 
ggplot(aes(state_of_health, number_of_people, fill = factor(level_happy)))+
  geom_col(position = "fill", stat = "identity") +
  labs(title = "Figure 2", 
      subtitle = "Feeling of happiness by self-rated state of health",
       x = "Self-rated state of health",
       y = "Feeling of happiness (Percent)",
       caption = "Survey of more than 85,000 respondents across the world. Source: WVS 2012")+
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 60, hjust = 1))

```


```{r trust, include=FALSE }

trust <- sum(255 + 1528 + 10369 + 6499) 
caution <- sum(1368 + 7619 + 29072 + 19512)
total <- sum(trust + caution)
percent_trust <- (trust/total)*100
percent_caution <- (caution/total)*100

happiness_trust <- data %>% 
  select("feeling_of_happiness", "most_people_trusted") %>%  
  group_by(most_people_trusted) %>% 
  mutate(feeling_of_happiness = fct_relevel(feeling_of_happiness,
                                            "Not at all happy",
                                            "Not very happy",
                                            "Rather happy"
                                            )) %>% 
  count(feeling_of_happiness)

apa_table(happiness_trust)

fig_trust <- happiness_trust %>% 
ggplot(aes(feeling_of_happiness, n))+
  geom_col(color = "red", fill = "lightblue")+
  facet_wrap(~most_people_trusted) +
  labs(title = "Figure 1", 
      subtitle = "Feeling of happiness by trust of people",
       x = "Feeling of happniess",
       y = "Number of people",
       caption = "Survey of more than 85,000 respondents across the world. Source: WVS 2012") +
    theme_minimal() +
  theme(axis.text.x = element_text(angle = 60, hjust = 1))

```
# Introduction

Study of happiness and its causal factors has flourished in recent years. Scholars have studied the relationship between happiness and variables ranging from the political system to cultural and economic factors [@inglehart200911; @schyns1998crossnational]. This project explores the relationship between happiness and some candidate variables, namely marital status, religious affiliation, level of income, status of heath, and level of trust. We use individual level survey of more than 85,000 respondents across 60 countries and societies around the world in World Value Survey Dataset 2012. 


# Methods

This project drew from survey data from the [World Values Survey](http://www.worldvaluessurvey.org/WVSContents.jsp). This is a survey of more than 85,000 respondents across 60 countries and societies around the world. We used data from the most recent wave which can be accessed [here](http://www.worldvaluessurvey.org/WVSDocumentationWV6.jsp). Our data analyses are descriptive and exploratory.  

## Data analysis and results

### Happiness and trust

In this section we examine the relationship between happiness and trust. Johnson [-@johnson2012much] finds that "trust as measured by the World Values Survey is positively correlated with experimentally measured trust".

Out of the total `r total` people, only slightly more than `r percent_trust` percent say they can trust most of the people around them, while `r percent_caution` are cautious about the society. Interestingly, there are more people feeling happy in life in the latter group than those in the former. Figure 1, below, indicates such difference.

```{r}
fig_trust
```

### Happiness and health status

Our data suggest a positive correlation between health status and perceived level of happiness. Figure 2, below, clearly indicates that most of people who rated their health status as "good" also felt happy. 
```{r}
fig_health
```

### Happiness and family savings

Of the `r total` survey participants, the majority (`r percent_just_get_by`) reported just getting by financially, while `r percent_save_money` saved money. The remainder spent either some (`r percent_spent_some_savings`) or all (`r percent_spent_savings`) of their savings.

Table 1 shows happiness levels by level of family savings. Relationships between happiness levels and family savings are explored in Figure 3. Here, we see that of those reporting the lowest levels of happiness (Not at all happy, Not very happy), most had spent all of their family savings. On the other hand, of those reporting the highest level of happiness (Very happy), the highest percentage were those in the strongest financial position - those who saved money.

```{r happiness by family APA table, results= 'asis'}

apa_table(happiness_by_family_savings)
```

```{r happiness by family savings tables and figures}

figure_savings_3
```

# Discussion

Our results illuminate a number of connections between happiness levels and other life factors such as trust of others, family financial status, and health.

Data for happiness levels overall were normally distributed, with the majority of participants reporting a moderate level of happiness, and fewer reporting very low or very high levels of happiness. This pattern continued to be evident when data were grouped by our independent variables.

Contrary to the conventional belief that people who feel happy they can trust people around them should feel more secured, hence happier. The data shows somewhat the opposite. Those who say they should be careful with the fellows surrounding them indicates higher level of happiness.

Results indicate that good health is associated with greater feelings of happiness. This affirms prior research by @gandelman2013happiness which found a strong relationship between self-rated health status and perceived life quality.

Results also suggest a positive relationship between family financial circumstances and happiness. Prior research has demonstrated a positive association between income and well-being, although the mechanisms for this remain unclear [@diener2010]. Our results build on this work by indicating that degree to which families are able to save money, or the degree to which they must deplete savings and/or take out loans, are areas worthy of further study. 

Our results should be interpreted with caution. Because we are beginners in using R, data analyses are, so far, only descriptive. Linear models are needed to explore whether the relationships suggested here are statistically significant. Furthermore, even if they were, these data are cross-sectional, so findings cannot be interpreted as indicating causality.  





\newpage

# References
```{r create_r-references}
r_refs(file = "r-references.bib")
```

\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}

<div id = "refs"></div>
\endgroup
